var IndiaBoundaryTest = (function (exports) {
  'use strict';

  var _documentCurrentScript = typeof document !== 'undefined' ? document.currentScript : null;
  const dataVersion = 'osm_20251210_231743_ne_5.1.1';

  // Auto-generated by scripts/generate-version.js - DO NOT EDIT
  const packageVersion = '0.0.3';

  // Package info for CDN URL construction
  const PACKAGE_NAME = '@india-boundary-corrector/data';
  const PMTILES_FILENAME = 'india_boundary_corrections.pmtiles';

  /**
   * CDNs that don't serve static assets (JS module transformers only)
   */
  const JS_ONLY_CDNS = new Set(['esm.sh', 'skypack.dev', 'cdn.skypack.dev']);

  // Default fallback CDN (jsDelivr has multi-CDN architecture, more reliable)
  const DEFAULT_CDN_URL = `https://cdn.jsdelivr.net/npm/${PACKAGE_NAME}@${packageVersion}/${PMTILES_FILENAME}`;
  // const DEFAULT_CDN_URL = `https://unpkg.com/${PACKAGE_NAME}@${packageVersion}/${PMTILES_FILENAME}`;

  /**
   * Layer names in the PMTiles file
   */
  const layers = {
    toAddOsm: 'to-add-osm',
    toDelOsm: 'to-del-osm',
    toAddNe: 'to-add-ne',
    toDelNe: 'to-del-ne',
  };

  /**
   * Detect the PMTiles URL from various sources:
   * 1. import.meta.url (for ESM bundlers - most reliable)
   * 2. Fallback to jsDelivr CDN with pinned version
   * 
   * Note: When this package is bundled into another bundle, import.meta.url
   * won't work and we fall back to the CDN URL. Users can override with
   * setPmtilesUrl() for self-hosted scenarios.
   */
  function detectPmtilesUrl() {
    // Try import.meta.url first (works in ESM environments)
    try {
      if (typeof ({ url: (_documentCurrentScript && _documentCurrentScript.tagName.toUpperCase() === 'SCRIPT' && _documentCurrentScript.src || new URL('bundle.js', document.baseURI).href) }) !== 'undefined' && (_documentCurrentScript && _documentCurrentScript.tagName.toUpperCase() === 'SCRIPT' && _documentCurrentScript.src || new URL('bundle.js', document.baseURI).href)) {
        const moduleUrl = new URL('.', (_documentCurrentScript && _documentCurrentScript.tagName.toUpperCase() === 'SCRIPT' && _documentCurrentScript.src || new URL('bundle.js', document.baseURI).href));
        // JS-only CDNs don't serve static files, fall back to default
        if (JS_ONLY_CDNS.has(moduleUrl.hostname)) {
          return DEFAULT_CDN_URL;
        }
        return new URL(PMTILES_FILENAME, moduleUrl).href;
      }
    } catch {
      // import.meta not available (UMD/CJS/bundled)
    }

    // Fallback to CDN with pinned version
    return DEFAULT_CDN_URL;
  }

  // Cache the detected URL
  let cachedPmtilesUrl = null;

  /**
   * Get the URL for the PMTiles file.
   * 
   * Detection priority:
   * 1. Manually set URL via setPmtilesUrl()
   * 2. import.meta.url (ESM environments)
   * 3. jsDelivr CDN fallback (pinned to current version)
   * 
   * For self-hosted deployments or custom bundling scenarios,
   * use setPmtilesUrl().
   * 
   * @returns {string} URL to the PMTiles file
   */
  function getPmtilesUrl() {
    if (cachedPmtilesUrl === null) {
      cachedPmtilesUrl = detectPmtilesUrl();
    }
    return cachedPmtilesUrl;
  }

  /**
   * Manually set the PMTiles URL.
   * Use this for self-hosted deployments or custom bundling scenarios.
   * 
   * @param {string} url - The URL to the PMTiles file
   * 
   * @example
   * // Self-hosted
   * setPmtilesUrl('/assets/india_boundary_corrections.pmtiles');
   * 
   * @example
   * // Different CDN
   * setPmtilesUrl('https://my-cdn.com/india_boundary_corrections.pmtiles');
   */
  function setPmtilesUrl(url) {
    cachedPmtilesUrl = url;
  }

  /**
   * Get the data version string
   * @returns {string} Data version identifier
   */
  function getDataVersion() {
    return dataVersion;
  }

  /**
   * Wrapper to test how getPmtilesUrl behaves in an IIFE bundle
   */
  function getUrl() {
    return getPmtilesUrl();
  }

  function setUrl(url) {
    setPmtilesUrl(url);
  }

  function getVersion() {
    return getDataVersion();
  }

  function getLayers() {
    return layers;
  }

  // Auto-log on load for easy testing
  console.log('=== India Boundary Data Package - IIFE Bundle Test ===');
  console.log('Data Version:', getDataVersion());
  console.log('Layers:', layers);
  console.log('PMTiles URL:', getPmtilesUrl());

  exports.getLayers = getLayers;
  exports.getUrl = getUrl;
  exports.getVersion = getVersion;
  exports.setUrl = setUrl;

  return exports;

})({});
